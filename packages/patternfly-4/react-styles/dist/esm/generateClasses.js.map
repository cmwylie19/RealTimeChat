{"version":3,"sources":["../../src/generateClasses.js"],"names":["camelcase","require","glob","dirname","basename","resolve","join","parse","readFileSync","outputFileSync","outDir","__dirname","pfStylesDir","cssFiles","sync","cwd","ignore","forEach","filePath","absFilePath","cssContent","cssOutputPath","getCSSOutputPath","newClass","cssToJSNew","replace","inlineCssFiles","cssString","cssClasses","getCSSClasses","distinctValues","Set","classDeclaration","modifiersDeclaration","className","key","formatClassName","cleanClass","trim","isModifier","push","classSection","length","match","Boolean","startsWith","pathToCSSFile","getFormattedCSSOutputPath","dir","name","formattedDir","nodeText","nodeIndex","lastIndexOf","substring"],"mappings":"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","sourcesContent":["/* eslint-disable global-require,import/no-dynamic-require */\nconst camelcase = require('camel-case');\n\nconst glob = require('glob');\nconst { dirname, basename, resolve, join, parse } = require('path');\nconst { readFileSync } = require('fs');\nconst { outputFileSync } = require('fs-extra');\n\nconst outDir = resolve(__dirname, '../css');\nconst pfStylesDir = dirname(require.resolve('@patternfly/patternfly/patternfly.css'));\n\nconst cssFiles = glob.sync('**/*.css', {\n  cwd: pfStylesDir,\n  ignore: ['assets/**', '*ie11*.css']\n});\n\n/* Copy @patternfly/patternfly styles */\ncssFiles.forEach(filePath => {\n  const absFilePath = resolve(pfStylesDir, filePath);\n  const cssContent = readFileSync(absFilePath, 'utf8');\n  const cssOutputPath = getCSSOutputPath(outDir, filePath);\n  const newClass = cssToJSNew(cssContent, `./${basename(cssOutputPath)}`);\n\n  outputFileSync(cssOutputPath, cssContent);\n  outputFileSync(cssOutputPath.replace('.css', '.ts'), newClass);\n});\n\n/* Copy inline styles in the src/css folder */\nconst inlineCssFiles = glob.sync('src/css/**/*.css');\n\ninlineCssFiles.forEach(filePath => {\n  const absFilePath = resolve(filePath);\n  const cssContent = readFileSync(absFilePath, 'utf8');\n  const cssOutputPath = getCSSOutputPath(outDir, filePath).replace('src/css/', '');\n  const newClass = cssToJSNew(cssContent, `./${basename(cssOutputPath)}`);\n\n  outputFileSync(cssOutputPath, cssContent);\n  outputFileSync(cssOutputPath.replace('.css', '.ts'), newClass);\n});\n\nfunction cssToJSNew(cssString, cssOutputPath = '') {\n  const cssClasses = getCSSClasses(cssString);\n  const distinctValues = [...new Set(cssClasses)];\n  const classDeclaration = [];\n  const modifiersDeclaration = [];\n\n  distinctValues.forEach(className => {\n    const key = formatClassName(className);\n    const cleanClass = className.replace('.', '').trim();\n    if (isModifier(className)) {\n      modifiersDeclaration.push(`'${key}': '${cleanClass}'`);\n    } else {\n      classDeclaration.push(`${key}: '${cleanClass}'`);\n    }\n  });\n  const classSection = classDeclaration.length > 0 ? `${classDeclaration.join(',\\n  ')},` : '';\n\n  return `import '${cssOutputPath}';\n\nexport default {\n  ${classSection}\n  modifiers: {\n    ${modifiersDeclaration.join(',\\n    ')}\n  }\n}`;\n}\n\nfunction getCSSClasses(cssString) {\n  return cssString.match(/(\\.)(?!\\d)([^\\s\\.,{\\[>+~#:)]*)(?![^{]*})/g); //eslint-disable-line\n}\n\nfunction formatClassName(className) {\n  return camelcase(className.replace(/pf-((c|l|m|u|is|has)-)?/g, ''));\n}\n\nfunction isModifier(className) {\n  return Boolean(className && className.startsWith) && className.startsWith('.pf-m-');\n}\n\nfunction getCSSOutputPath(absFilePath, pathToCSSFile) {\n  return join(absFilePath, getFormattedCSSOutputPath(pathToCSSFile));\n}\n\nfunction getFormattedCSSOutputPath(pathToCSSFile) {\n  const { dir, name } = parse(pathToCSSFile);\n  let formattedDir = dir;\n  const nodeText = 'node_modules';\n  const nodeIndex = formattedDir.lastIndexOf(nodeText);\n  if (nodeIndex !== -1) {\n    formattedDir = formattedDir.substring(nodeIndex + nodeText.length);\n  }\n  return join(formattedDir, `${name}.css`);\n}\n"],"file":"generateClasses.js"}