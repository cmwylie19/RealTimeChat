{"version":3,"sources":["../../../../src/components/Virtualized/defaultCellRangeRenderer.ts"],"names":["defaultCellRangeRenderer","cellCache","cellRenderer","columnSizeAndPositionManager","columnStartIndex","columnStopIndex","deferredMeasurementCache","horizontalOffsetAdjustment","isScrolling","isScrollingOptOut","parent","rowSizeAndPositionManager","rowStartIndex","rowStopIndex","styleCache","verticalOffsetAdjustment","visibleColumnIndices","visibleRowIndices","renderedCells","areOffsetsAdjusted","canCacheStyle","rowIndex","rowDatum","getSizeAndPositionOfCell","columnIndex","columnDatum","isVisible","start","stop","key","style","has","height","left","position","top","width","size","offset","cellRendererParams","renderedCell","process","env","NODE_ENV","warnAboutMissingStyle","push","type","__internalCellMeasurerFlag","props","children","undefined","__warnedAboutMissingStyle","console","warn"],"mappings":"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","sourcesContent":["/* eslint-disable */\n\nimport { CellRangeRendererParams } from './types';\n\n/**\n * Default implementation of cellRangeRenderer used by Grid.\n * This renderer supports cell-caching while the user is scrolling.\n */\n\nexport default function defaultCellRangeRenderer({\n  cellCache,\n  cellRenderer,\n  columnSizeAndPositionManager,\n  columnStartIndex,\n  columnStopIndex,\n  deferredMeasurementCache,\n  horizontalOffsetAdjustment,\n  isScrolling,\n  isScrollingOptOut,\n  parent, // Grid (or List or Table)\n  rowSizeAndPositionManager,\n  rowStartIndex,\n  rowStopIndex,\n  styleCache,\n  verticalOffsetAdjustment,\n  visibleColumnIndices,\n  visibleRowIndices\n}: CellRangeRendererParams) {\n  const renderedCells = [];\n\n  // Browsers have native size limits for elements (eg Chrome 33M pixels, IE 1.5M pixes).\n  // User cannot scroll beyond these size limitations.\n  // In order to work around this, ScalingCellSizeAndPositionManager compresses offsets.\n  // We should never cache styles for compressed offsets though as this can lead to bugs.\n  // See issue #576 for more.\n  const areOffsetsAdjusted =\n    columnSizeAndPositionManager.areOffsetsAdjusted() || rowSizeAndPositionManager.areOffsetsAdjusted();\n\n  const canCacheStyle = !isScrolling && !areOffsetsAdjusted;\n\n  for (let rowIndex = rowStartIndex; rowIndex <= rowStopIndex; rowIndex++) {\n    const rowDatum = rowSizeAndPositionManager.getSizeAndPositionOfCell(rowIndex);\n\n    for (let columnIndex = columnStartIndex; columnIndex <= columnStopIndex; columnIndex++) {\n      const columnDatum = columnSizeAndPositionManager.getSizeAndPositionOfCell(columnIndex);\n      const isVisible =\n        columnIndex >= visibleColumnIndices.start &&\n        columnIndex <= visibleColumnIndices.stop &&\n        rowIndex >= visibleRowIndices.start &&\n        rowIndex <= visibleRowIndices.stop;\n      const key = `${rowIndex}-${columnIndex}`;\n      let style;\n\n      // Cache style objects so shallow-compare doesn't re-render unnecessarily.\n      if (canCacheStyle && styleCache[key]) {\n        style = styleCache[key];\n      } else {\n        // In deferred mode, cells will be initially rendered before we know their size.\n        // Don't interfere with CellMeasurer's measurements by setting an invalid size.\n        if (deferredMeasurementCache && !deferredMeasurementCache.has(rowIndex, columnIndex)) {\n          // Position not-yet-measured cells at top/left 0,0,\n          // And give them width/height of 'auto' so they can grow larger than the parent Grid if necessary.\n          // Positioning them further to the right/bottom influences their measured size.\n          style = {\n            height: 'auto',\n            left: 0,\n            position: 'absolute',\n            top: 0,\n            width: 'auto'\n          };\n        } else {\n          style = {\n            height: rowDatum.size,\n            left: columnDatum.offset + horizontalOffsetAdjustment,\n            position: 'absolute',\n            top: rowDatum.offset + verticalOffsetAdjustment,\n            width: columnDatum.size\n          };\n\n          styleCache[key] = style;\n        }\n      }\n\n      const cellRendererParams = {\n        columnIndex,\n        isScrolling,\n        isVisible,\n        key,\n        parent,\n        rowIndex,\n        style\n      };\n\n      let renderedCell;\n\n      // Avoid re-creating cells while scrolling.\n      // This can lead to the same cell being created many times and can cause performance issues for \"heavy\" cells.\n      // If a scroll is in progress- cache and reuse cells.\n      // This cache will be thrown away once scrolling completes.\n      // However if we are scaling scroll positions and sizes, we should also avoid caching.\n      // This is because the offset changes slightly as scroll position changes and caching leads to stale values.\n      // For more info refer to issue #395\n      //\n      // If isScrollingOptOut is specified, we always cache cells.\n      // For more info refer to issue #1028\n      if ((isScrollingOptOut || isScrolling) && !horizontalOffsetAdjustment && !verticalOffsetAdjustment) {\n        if (!cellCache[key]) {\n          cellCache[key] = cellRenderer(cellRendererParams);\n        }\n\n        renderedCell = cellCache[key];\n\n        // If the user is no longer scrolling, don't cache cells.\n        // This makes dynamic cell content difficult for users and would also lead to a heavier memory footprint.\n      } else {\n        renderedCell = cellRenderer(cellRendererParams);\n      }\n\n      if (renderedCell == null || renderedCell === false) {\n        continue;\n      }\n\n      if (process.env.NODE_ENV !== 'production') {\n        warnAboutMissingStyle(parent, renderedCell);\n      }\n\n      renderedCells.push(renderedCell);\n    }\n  }\n\n  return renderedCells;\n}\n\nfunction warnAboutMissingStyle(parent, renderedCell) {\n  if (process.env.NODE_ENV !== 'production') {\n    if (renderedCell) {\n      // If the direct child is a CellMeasurer, then we should check its child\n      // See issue #611\n      if (renderedCell.type && renderedCell.type.__internalCellMeasurerFlag) {\n        renderedCell = renderedCell.props.children;\n      }\n\n      if (\n        renderedCell &&\n        renderedCell.props &&\n        renderedCell.props.style === undefined &&\n        parent.__warnedAboutMissingStyle !== true\n      ) {\n        parent.__warnedAboutMissingStyle = true;\n\n        console.warn('Rendered cell should include style property for positioning.');\n      }\n    }\n  }\n}\n"],"file":"defaultCellRangeRenderer.js"}